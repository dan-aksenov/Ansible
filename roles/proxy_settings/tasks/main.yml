---
- name: Edit yum.conf. Add proxy setting.
  lineinfile: 
      dest: /etc/yum.conf
      regexp: '^proxy'
      line: 'proxy={{ proxy_ip }}'
  tags: proxy_yum
  when: proxy_ip is defined

- name: Edit yum.conf. Remove proxy setting.
  lineinfile: 
      dest: /etc/yum.conf
      regexp: '^proxy'
      state: absent
  tags: proxy_yum
  when: proxy_ip is not defined
